# phASER Annotate
Takes an input phased VCF and SNP annotation and outputs all possible allele configurations.

Developed by [Stephane E. Castel](mailto:stephanecastel@gmail.com) in the [Lappalainen Lab](http://tllab.org) at the New York Genome Center and Columbia University Department of Systems Biology.

Runs on Python 3.x.x has the following dependencies: [pysam](https://github.com/pysam-developers/pysam), [pyVCF](https://pyvcf.readthedocs.org)

Requires that the CADD file containing all possible SNVs incl. all annotations for the reference of interest and its index be downloaded (can be found [here](http://cadd.gs.washington.edu/download)).

# Usage
Requires a phased VCF, does not need to have been generated by phASER. If a phASER phased VCF is used the output will indicate which allele configurations are read backed.

# Arguments
## Required
* **--geno_vcf** - VCF containing phased genotype (can be gzipped).
* **--sample** - Name of sample to use in VCF file.
* **--af_vcf** - VCF to retrieve allele frequencies from. Must be indexed with tabix. If left blank will attempt to retrieve from genotype vcf.
* **--af_field** _(AF)_ - Allele frequency field in af_vcf to use.
* **--cadd_file** - The path to the CADD 'whole_genome_SNVs.tsv.gz' file, which contains a CADD score and annotation for every SNV in the genome.
* **--o** - Output file.

# Optional
* **--threads** _(1)_ - Number of threads to use.

# Output File

Contains all the allele configurations for each pair of variants within a annotation (gene).

* 1 - **ensg** - Ensembl gene id.
* 2 - **name** - Gene name.
* 3 - **variant_a** - Unique ID of first variant.
* 4 - **rsid_a** - RS ID of first variant.
* 5 - **allele_a** - Allele of first variant.
* 6 - **af_a** - Alelle frequency of allele a.
* 7 - **cadd_phred_a** - CADD phred score for allele a.
* 8 - **cadd_effect_a** - Predicted effect of allele a.
* 9 - **allele_b** - Allele of first variant.
* 10 - **af_b** - Alelle frequency of allele b.
* 11 - **cadd_phred_b** - CADD phred score for allele b.
* 12 - **cadd_effect_b** - Predicted effect of allele b.
* 13 - **configuration** - Either _cis_ (alleles on same haplotype) or _trans_ (alleles on different haplotypes).
* 14 - **read_backed** - Allele configuration was observed using read backed data (only applicable if input VCF was phased with phASER).
